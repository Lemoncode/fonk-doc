(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{T0eK:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return i})),a.d(t,"default",(function(){return b}));var n=a("Fcif"),r=a("+I+c"),l=a("/FXl"),o=a("TjRS"),i=(a("aD51"),{});void 0!==i&&i&&i===Object(i)&&Object.isExtensible(i)&&!i.hasOwnProperty("__filemeta")&&Object.defineProperty(i,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"general/validating-record.mdx"}});var c={_frontmatter:i},s=o.a;function b(e){var t=e.components,o=Object(r.a)(e,["components"]);return Object(l.b)(s,Object(n.a)({},c,o,{components:t,mdxType:"MDXLayout"}),Object(l.b)("h1",{id:"record-validations"},"Record Validations"),Object(l.b)("p",null,"Field validations are great, but sometimes we need to fire validations once the user has fulfilled all\nthe form values (typically just when the user hits the ",Object(l.b)("em",{parentName:"p"},"submit")," button), how can we fire this kind\nof validations? using the ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/fonk-doc/api#formvalidation"}),Object(l.b)("strong",{parentName:"a"},"FormValidation"))," ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/fonk-doc/api#validaterecord"}),Object(l.b)("strong",{parentName:"a"},"validateRecord"))," method."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),"validateRecord(values: any): Promise<RecordValidationResult>\n")),Object(l.b)("p",null,"In this method we pass as arguments:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"All the record values, usually this kind of validation needs access to the whole form data.")),Object(l.b)("p",null,"And it returns"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"Whether all the associated record validations passed or failed (in case just one of the validations failed)."),Object(l.b)("li",{parentName:"ul"},"A list of results including the result of firing all the record validations.")),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"This behavior is different to ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/fonk-doc/api#validatefield"}),"ValidateField"),", because validate field is over one field, validateRecord is over a list of records. You get success or stops the process\nFor each record has same behaviour like validateField.")),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"You can find detailed information about this method in the ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/fonk-doc/api#validaterecord"}),"api definition"),".")),Object(l.b)("p",null,"Let's get our hands wet:"),Object(l.b)("p",null,"We want to validate that, the user gets freeshipping if he is subscribed to ",Object(l.b)("em",{parentName:"p"},"prime services")," or\nif the total amount purchase is greater than 30 USD."),Object(l.b)("p",null,"Let's start with the following model:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),"const checkoutForm = {\n  product: 'shoes',\n  price: 20,\n  discount: 5,\n  isPrime: false,\n};\n")),Object(l.b)("p",null,"Let's define a Record Validator:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"const freeShippingRecordValidator = ({ values }) => {\n  const succeeded = values.isPrime || values.price - values.discount > 20;\n\n  return {\n    succeeded,\n    message: succeeded\n      ? ''\n      : 'Subscribe to prime service or total must be greater than 20USD',\n    type: 'RECORD_FREE_SHIPPING',\n  };\n};\n")),Object(l.b)("blockquote",null,Object(l.b)("p",{parentName:"blockquote"},"More information about record validators in this ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/fonk-doc/api#recordvalidation-function-type"}),"link"),".")),Object(l.b)("p",null,"And let's define our form validation schema:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"const validationSchema = {\n  record: {\n    freeShipping: [freeShippingRecordValidator],\n  },\n};\n\nconst formValidation: FormValidation = createFormValidation(validationSchema);\n")),Object(l.b)("p",null,"Now if we want fire the form record validation we only need to call:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"formValidation.validateRecord(checkoutForm).then(recordValidationResult => {\n  console.log(recordValidationResult);\n});\n")),Object(l.b)("p",null,"In this case it will return:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),'{\n  "succeeded": false,\n  "recordErrors": {\n    "freeShipping": {\n      "succeeded": false,\n      "message": "Subscribe to prime service or total must be greater than 20USD",\n      "type": "RECORD_FREE_SHIPPING"\n    }\n  }\n}\n')),Object(l.b)("p",null,"The record validation failed, we can show a message to the user asking to subscribe to prime services or adding more items to his basket to get free shipping cost."),Object(l.b)("p",null,"If we update the values of the form, e.g. the user has contracted ",Object(l.b)("em",{parentName:"p"},"prime services")," it will return\na validation succeeded."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),"checkoutForm.isPrime = true;\n")),Object(l.b)("p",null,"And we fire the record validation:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"formValidation.validateRecord(checkoutForm).then(recordValidationResult => {\n  console.log(recordValidationResult);\n});\n")),Object(l.b)("p",null,"It will return:"),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),'{\n  "succeeded": true,\n  "recordErrors": {\n    "freeShipping": {\n      "succeeded": true,\n      "message": "",\n      "type": "RECORD_FREE_SHIPPING"\n    }\n  }\n}\n')),Object(l.b)("p",null,"The record validation succeeded."),Object(l.b)("p",null,Object(l.b)("img",{alt:"validate-record",src:a("awue")})),Object(l.b)("p",null,"Examples:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://codesandbox.io/s/github/lemoncode/fonk/tree/master/examples/vanilla/js/validate-record"}),"Plain Vanilla JS"),"."),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://codesandbox.io/s/github/lemoncode/fonk/tree/master/examples/vanilla/ts/validate-record"}),"Plain Vanilla TS"),".")),Object(l.b)("p",null,"React final form examples:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://codesandbox.io/s/github/lemoncode/fonk/tree/master/examples/react-final-form/js/validate-record"}),"React + React Final Form JS"),"."),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://codesandbox.io/s/github/lemoncode/fonk/tree/master/examples/react-final-form/ts/validate-record"}),"React + React Final Form TS"),".")),Object(l.b)("p",null,"Vuejs"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(n.a)({parentName:"li"},{href:"https://codesandbox.io/s/github/Lemoncode/fonk/tree/master/examples/vue/js/validate-record"}),"Vuejs + JS"))),Object(l.b)("p",null,"Now that you know how to fire validate field & record validations \nlet's jump firing all the validation together ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"/fonk-doc/validating-form"}),"form validations")))}void 0!==b&&b&&b===Object(b)&&Object.isExtensible(b)&&!b.hasOwnProperty("__filemeta")&&Object.defineProperty(b,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"general/validating-record.mdx"}}),b.isMDXComponent=!0},awue:function(e,t,a){e.exports=a.p+"static/validate-record-2ed0fb7daf0f2685a52e5a0fa9a776ee.gif"}}]);
//# sourceMappingURL=component---general-validating-record-mdx-2cab1c0d8104a8e1cf94.js.map