---
name: api
menu: 5. api
---

# api

In this page we will defined the form-validation api.

## Validaton Result structures

### ValidationResult

A field or record validation function will return a
_ValidationResult_

Properties

- **type**: Validator applied (e.g. required, email, min-lenght...).
- **succeeded**: Wether if the validation succeeded (true) or failed (false).
- **message**: Error message. Empty if all the validations evaluated succeeded.

```typescript
export class ValidationResult {
  type: string;
  succeeded: boolean;
  message: string;
}
```

### RecordValidationResults

Whenever we validate all form record entries (ValidateRecord),
a _RecordValidationResult_ is returned.

- **succeeded**: Whether if the record validations succeeded (true) or failed (false).
- **recordErrors**: collection of validation results.

```typescript
export interface RecordValidationResult {
  succeeded: boolean;
  recordErrors: { [recordId: string]: ValidationResult };
}
```

### FormValidationResult

Whenever we validate a form _validateForm_ (trigger
all field and record validations associated to that form) it
will return a _FormValidationResult_.

```typescript
export interface FormValidationResult {
  succeeded: boolean;
  fieldErrors: { [fieldId: string]: ValidationResult };
  recordErrors: { [recordId: string]: ValidationResult };
}
```

Properties:

- **succeeded**: Whether if all validations succeeded (true) or any of them failed (false).
- **fieldErrors**: Collection of field / ValidationResults.
- **recordErrors**: Collections of record / ValidationResults.

## Validation Schema definition

### FieldValidationArgs

[FieldValidation](###Field-Validation) functions accept as input parameters _FieldValidationArgs_,
the form-validation engine will feed the needed properties to the validator when a field
validation is fired.

properties:

- **value**: current value of the field to be evaluated.
- **values**: whole form values (all fields associated to the form).
- **customArgs**: if we need to pass any configuration parameter to the validator (for instance, in a
  min-length validation the numeric value, or in a password matches another field the id of the field to compare against).
- **message**: you can override the default error(s) message generated by the validators and set your own (for instance
  in a regEx / pattern validation you may want to customize the error message for a credit card field to something like _this is not a
  valid credit card number_ instead of the generic _Pattern does not match_).

```typescript
export interface FieldValidatorArgs {
  value: any;
  values?: any;
  customArgs?: any;
  message?: string | string[];
}
```

### FieldValidation function type

FieldValidation function type is the ones used to define field validator functions (for instance a function
that validates if a field has been informed, or if it is a valid email). FieldValidation apply to a single field
altough is possible that a field validation could read values from another form field (for instance the field _PartnerId_
is required only if the _isPartner_ boolean value is true),

Field validator functions must comply with a given signature, in this case we accept
two signatures, sync and async.

**Sync version**

Arguments

- **fieldValidatorArgs**: We pass here information like id of the field
  to validate, actual value, values and customArgs. See **internal link**
  for more information.

Return Value

- **ValidationResult**: Whether if field validations applied to the selected field
  succeeded or not (in case not, additional information to be provided like id of the validator that failed plus error message).

```typescript
(fieldValidatorArgs: FieldValidatorArgs) => ValidationResult;
```

**Async version**

Arguments

- **fieldValidatorArgs**: We pass here information like id of the field
  to validate, actual value, values and customArgs. See **internal link**
  for more information.

Return Value

- **Promise<ValidationResult\>**: Async promise, once promise is resolved returns whether if field validations applied to the selected field
  succeeded or not (in casenot additional information to be provided like id of the validator that failed plus error message).

```typescript
(fieldValidatorArgs: FieldValidatorArgs) => Promise<ValidationResult>;
```

### RecordValidationArgs

[RecordValidation functions](###RecordValidation-function-type) functions accept as input parameters _RecordValidationArgs_,
the form-validation engine will feed the needed properties to the validator when a record
validation is fired.

properties:

- **values**: whole form values (all fields associated to the form).
- **message**: you can override the default error(s) message generated by the record validators and set your own.

```typescript
export interface RecordValidatorArgs {
  values: any;
  message?: string | string[];
}
```

### RecordValidation function type

RecordValidation function type is the one used to define record validator functions. What is a record validator function?
These validations are associated to the whole form instead of a single field, for instance: if the total amount
of your shopping cart is more than 50 USD then you get free shipping, if not warn the user.

Field validator functions must comply with a given signature, in this case we accept
two signatures, sync and async.

Sync version

Arguments

- **recordValidatorArgs**: We pass here information like id of the field
  to validate, actual value, values and customArgs. See **internal link**
  for more information.

Return Value

- **ValidationResult**: Whether if field validations applied to the selected field
  succeeded or not (in casenot additional information to be provided like id of the validator that failed plus error message).

```typescript
(recordValidatorArgs: RecordValidatorArgs) => ValidationResult;
```

Async version

```typescript
(fieldValidatorArgs: FieldValidatorArgs) => Promise<ValidationResult>;
```

### ValidationSchema

In this structure we can define all the validations associated to a given form (field and record validations).

This allow us to define all validation associated to a given form in a declarative way.

Properties:

- **field**: optional entry, here we can define all field validations associated to a given form
  (see [FieldValidationSchema](###field-validation-schema) for more info link.

- **record**: optional entry, here we can define all record validations associated to a given form
  (see [RecordValidationSchema)[###record-validation-schema])

```typescript
export interface ValidationSchema {
  field?: FieldValidationSchema;
  record?: RecordValidationSchema;
}
```

#### Examples:

**Schema Field validations**

Let's say we have a login form, and the following record:

```javascript
const loginModel = {
  user,
  password
};
```

We want to validate that both user and password are required field, a validation
schema to define these validations:

```javascript
import { required } from "form-validation";

const loginFormValidationSchema = {
  field: {
    user: [required],
    password: [required]
  }
};
```

Let's follow up completing this form validation, in this case we want to ensure
that the user field is required and a well formed email address:

```javascript
import { required, email } from "form-validation";

const loginFormValidationSchema = {
  field: {
    user: [required, email],
    password: [required]
  }
};
```

Let's add one more step of complexity in this case we want to ensure that
the password field name is at least 5 characters length, we can use the
min-length validator, but we have to feed and additional parameter to
indicate the minumum length, in this case the validation schema accepts
both function and structure based definition to include validation we will
use the second option.

```javascript
import { required, email, minLength } from "form-validation";

const loginFormValidationSchema = {
  field: {
    user: [required, email],
    password: [
      required,
      {
        validator: minLength,
        customArgs: { length: 3 }
      }
    ]
  }
};
```

TODO: Add codepen for both cases (or codesandbox)

You can define as well:

- Asynchronous validations, example.
- FieldValidators that read from other record field values, example.

**Record Field validations**

Sometimes you need to create global validation that is not tied up to a specific field, or
you want it to be fired once the user has fullfilled all the data in the validation form, a
use case for this type of validation could be: shopping cart checkout, offer free shipping
if total amount (including discount) is greater than 30 USD

```javascript
import { required, email } from "form-validation";
const checkoutForm = {
   subtotal,
   discount,
   total,
   freeshipping,
  }
};
```

Let's define our record validator rule:

```javascript
const freeShippingAllowed = values => ({});
```

```javascript
const checkoutFormValidationSchema = {
  record: {
    user: [required, email],
    password: [required]
  }
};
```

(Amount, discount, free shpping,total)
